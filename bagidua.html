<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- supaya Responsif di perangkat mobile -->
  <title>Metode Bagi Dua</title> <!-- Judul halaman -->
  <style>
    body {
      font-family: Arial, sans-serif; /* menyetel font menjadi arial dan sans-serif */
      margin: 10px; /* Menambahkan margin sebesar 10 pixel */
    }
    nav ul {
      list-style: none;
      padding: 0;
    }
    nav ul li {
      display: inline;
      margin: 0 15px;
    }
    nav ul li a {
        color: white;
        text-decoration: none;
        font-weight: bold;
    }
    .Metode {
      display: grid;
      text-align: center; /* Teksnya ditaruh di tengah */
      background-color: rgb(0, 200, 255); /* Warna latar */
      margin-top: 5px; /* Margin atas 5 pixel */
      margin-bottom: 5px; /* Margin bawah 5 pixel */
      color: white;
    }

    .isi {
      display: grid;
      grid-template-columns: 50% 50%; /* Dua kolom: kiri sebesar 50% & kanan sebesar 50% */
      margin-bottom: 5px; /* Margin bawah 5 pixel */
      gap: 5px; /* celah antara kolom sebesar 5 pixel */
    }

    .isikiri, .isikanan {
        background-color: rgb(0, 200, 255); /* Warna latar input dan grafik */
      padding: 20px; /* Ruang dalam */
    }

    table {
      text-align: center;
      width: 100%; /* Lebar tabel 100% */
      margin-top: 20px; /* Margin atas 20 pixel */
      border-collapse: collapse; 
    }

    input, button {
      padding: 8px;
      margin: 5px;
    }

    table, th, td {
      border: 1px solid black; /* Garis tepi tabel */
      padding: 5px;
    }
  </style>
</head>
<body>
  <div class="Metode">
    <h1>Mencari Hampiran Akar Dengan Metode Bagi Dua</h1> <!-- Judul utama halaman -->
     <nav>
      <ul>
        <li><a href="bagidua.html">Bagi Dua</a></li>
        <li><a href="secant.html">Secant</a></li>
      </ul>
    </nav>
  </div>

  <div class="isi">
    <div class="isikiri"> <!-- Kolom kiri: input -->
      <label>Fungsi f(x): <input type="text" id="fungsi" placeholder="contoh: x^4-2" /></label><br /> <!-- Tempat memasukkan fungsi -->
      <label>Nilai a: <input type="number" id="a" step="any" /></label><br/> <!-- Tempat memasukkan nilai a dan dengan type angka -->
      <label>Nilai b: <input type="number" id="b" step="any" /></label><br /> <!-- Tempat memasukkan nilai b dan dengan type angka -->
      <label>Îµ (Toleransi Error): <input type="number" id="epsilon" value="" step="any" placeholder="contoh: 0.0001" /></label><br /> <!-- Tempat memasukkan nilai epsilon dan dengan type angka -->
      <label>Maksimum Iterasi: <input type="number" id="batasIterasi" value="" /></label><br /> <!-- Tempat memasukkan maksimum iterasi dan dengan type angka -->
      <button onclick="cariAkar()">Cari akar</button> <!-- Tombol jalankan metode -->
      <button onclick="hapusInput()">Hapus</button> <!-- Tombol hapus input -->
    </div>

    <div class="isikanan" id="ggb-element"></div> <!-- Kolom kanan: tempat grafik GeoGebra -->
  </div>

  <div class="kotak">
    <table id="hasil"> <!-- Tabel hasil iterasi -->
      <thead> <!-- kepala tabelnya -->
        <tr> <!-- baris tabel -->
          <th>i</th> <!-- kolom i -->
          <th>a</th> <!-- kolom a-->
          <th>b</th> <!-- kolom b -->
          <th>T</th> <!-- kolom T -->
          <th>f(a)</th> <!-- kolom f(a) -->
          <th>f(b)</th> <!-- kolom f(b) -->
          <th>f(T)</th> <!-- kolom f(T) -->
          <th>Ket</th> <!-- kolom keterangan -->
        </tr>
      </thead>
      <tbody></tbody> <!-- isi tabelnya dari javascript -->
    </table>
  </div>

  <script src="https://www.geogebra.org/apps/deployggb.js"></script>

  <script>
    function UbahFungsi(input) {
      return input.replace(/([a-zA-Z0-9\.]+)\s*\^\s*([0-9]+)/g, 'Math.pow($1, $2)'); 
    }

    function f(x, fungsi) {
      const parsedFungsi = UbahFungsi(fungsi);
      return Function('x', 'return ' + parsedFungsi)(x);
    }

    function cariAkar() {
      const fungsi = document.getElementById("fungsi").value; 
      let a = parseFloat(document.getElementById("a").value); 
      let b = parseFloat(document.getElementById("b").value); 
      const epsilon = parseFloat(document.getElementById("epsilon").value);
      const batasIterasi = parseInt(document.getElementById("batasIterasi").value); 

      const tbody = document.querySelector("#hasil tbody");
      tbody.innerHTML = ""; 
      let i = 1; 
      let T, fA, fB, fT;
      let keterangan = ""; 

      while (i <= batasIterasi) { 
        fA = f(a, fungsi); 
        fB = f(b, fungsi); 
        T = (a + b) / 2; 
        fT = f(T, fungsi); 

        if (fA * fT < 0) { 
          keterangan = "b:=T"; 
        } else { 
          keterangan = "a:=T"; 
        }

        tbody.innerHTML += `
          <tr>
            <td>${i}</td>
            <td>${a.toFixed(6)}</td>
            <td>${b.toFixed(6)}</td>
            <td>${T.toFixed(6)}</td>
            <td>${fA.toFixed(6)}</td>
            <td>${fB.toFixed(6)}</td>
            <td>${fT.toFixed(6)}</td>
            <td>${keterangan}</td>
          </tr>
        `;

        if (Math.abs(fT) < epsilon || Math.abs(b - a) < epsilon) break;

        if (fA * fT < 0) {
          b = T;
        } else {
          a = T;
        }

        i++;
      }

      tampilkanGeoGebra(fungsi);
    }

    function hapusInput() {
      document.getElementById("fungsi").value = "";
      document.getElementById("a").value = "";
      document.getElementById("b").value = "";
      document.getElementById("epsilon").value = "";
      document.getElementById("batasIterasi").value = "";
    }

    function tampilkanGeoGebra(fungsi) {
      const ekspresiGeoGebra = fungsi.replace(/\^/g, "^");

      const params = {
        "appName": "graphing", 
         "width": 800,         
         "height": 400,        
        };
      const container = document.getElementById("ggb-element");
      container.innerHTML = "";

      const app = new GGBApplet(params, true);
      app.inject("ggb-element"); 

      setTimeout(() => {
        try {
          const ggb = app.getAppletObject();
          ggb.evalCommand("f(x) ="+ekspresiGeoGebra); 
        } catch (e) {
          alert("Fungsi tidak valid untuk GeoGebra.");
        }
      }, 1500);
    }
  </script>
</body>
</html>
